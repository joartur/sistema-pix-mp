<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Pagamentos PIX</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <style>
        /* Estilos permanecem os mesmos */
        * { font-family: 'Inter', sans-serif; }
        body { background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%); min-height: 100vh; }
        .card-shadow { box-shadow: 0 20px 40px rgba(0, 0, 0, 0.08), 0 10px 15px rgba(0, 0, 0, 0.05); }
        .gradient-primary { background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%); }
        .gradient-success { background: linear-gradient(135deg, #059669 0%, #047857 100%); }
    </style>
</head>
<body class="flex items-center justify-center p-4">
    <div class="container max-w-4xl mx-auto">
        <!-- Header permanece igual -->

        <!-- Card Principal -->
        <div class="bg-white rounded-2xl card-shadow overflow-hidden">
            <!-- Conteúdo do Card -->
            <div class="p-8">
                <!-- Valores Recomendados -->
                <div class="mb-12">
                    <h3 class="text-xl font-semibold text-gray-800 mb-6">Valores disponíveis</h3>
                    
                    <div class="grid grid-cols-1 sm:grid-cols-3 gap-6">
                        <!-- Botões de valor -->
                        <button onclick="selectAmount(0.01)" class="amount-option p-6 rounded-xl border-2 border-gray-200 hover:border-blue-500 hover:bg-blue-50 transition-all duration-300">
                            <div class="text-3xl font-bold text-gray-900">R$ 0,01</div>
                        </button>
                        
                        <button onclick="selectAmount(1.00)" class="amount-option p-6 rounded-xl border-2 border-gray-200 hover:border-green-500 hover:bg-green-50 transition-all duration-300">
                            <div class="text-3xl font-bold text-gray-900">R$ 1,00</div>
                        </button>
                        
                        <button onclick="selectAmount(10.00)" class="amount-option p-6 rounded-xl border-2 border-gray-200 hover:border-purple-500 hover:bg-purple-50 transition-all duration-300">
                            <div class="text-3xl font-bold text-gray-900">R$ 10,00</div>
                        </button>
                    </div>
                </div>

                <!-- Valor Personalizado -->
                <div class="mb-12">
                    <div class="flex flex-col lg:flex-row gap-6 items-end">
                        <div class="flex-1">
                            <div class="relative">
                                <div class="absolute left-5 top-1/2 transform -translate-y-1/2 text-gray-700 font-medium">R$</div>
                                <input type="number" 
                                       id="customAmount" 
                                       step="0.01" 
                                       min="0.01"
                                       placeholder="0,00" 
                                       class="w-full pl-14 pr-5 py-5 text-xl border-2 border-gray-300 rounded-xl focus:border-blue-500 focus:ring-3 focus:ring-blue-200 transition-all duration-300">
                            </div>
                        </div>
                        <button onclick="processPayment()" class="px-10 py-5 gradient-primary hover:opacity-95 text-white font-bold text-lg rounded-xl transition-all duration-300 flex items-center justify-center">
                            <i class="fas fa-play-circle mr-3 text-xl"></i>
                            Gerar Pagamento
                        </button>
                    </div>
                </div>

                <!-- Resultado -->
                <div id="resultSection" class="hidden">
                    <div class="border-t pt-10">
                        <!-- Detalhes da Transação -->
                        <div class="grid md:grid-cols-2 gap-8 mb-10">
                            <!-- Informações -->
                            <div class="space-y-6">
                                <div class="bg-gray-50 p-5 rounded-xl">
                                    <div class="text-sm text-gray-500 font-medium mb-2">ID DA TRANSAÇÃO</div>
                                    <div id="paymentId" class="font-mono text-gray-900 text-lg font-bold"></div>
                                </div>
                                
                                <div class="bg-gray-50 p-5 rounded-xl">
                                    <div class="text-sm text-gray-500 font-medium mb-2">VALOR DA TRANSAÇÃO</div>
                                    <div id="paymentAmount" class="text-4xl font-bold text-green-600"></div>
                                </div>
                                
                                <!-- QR Code Gerado -->
                                <div id="qrCodeContainer" class="bg-gray-50 p-5 rounded-xl flex flex-col items-center justify-center">
                                    <div class="text-sm text-gray-500 font-medium mb-2">QR CODE</div>
                                    <div id="qrCodeImage" class="w-48 h-48 mb-3"></div>
                                    <p class="text-gray-600 text-sm text-center">Escaneie com seu app bancário</p>
                                </div>
                                
                                <!-- Código PIX Copiável -->
                                <div class="bg-gray-50 p-5 rounded-xl">
                                    <div class="text-sm text-gray-500 font-medium mb-2">CÓDIGO PIX (Copia e Cola)</div>
                                    <div id="pixCodeText" class="font-mono text-gray-800 text-sm break-all mb-3"></div>
                                    <button onclick="copyPixCode()" class="w-full py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                                        <i class="far fa-copy mr-2"></i>Copiar Código
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Instruções -->
                            <div class="bg-blue-50 p-6 rounded-xl">
                                <h4 class="font-semibold text-blue-900 mb-4">Como pagar:</h4>
                                <div class="space-y-4">
                                    <div class="flex items-start">
                                        <div class="w-8 h-8 bg-white rounded-full flex items-center justify-center mr-3 mt-1">
                                            <span class="text-blue-600 font-bold">1</span>
                                        </div>
                                        <p class="text-blue-800">Abra seu app bancário e selecione "Pagar com PIX"</p>
                                    </div>
                                    <div class="flex items-start">
                                        <div class="w-8 h-8 bg-white rounded-full flex items-center justify-center mr-3 mt-1">
                                            <span class="text-blue-600 font-bold">2</span>
                                        </div>
                                        <p class="text-blue-800">Escaneie o QR Code ou cole o código PIX</p>
                                    </div>
                                    <div class="flex items-start">
                                        <div class="w-8 h-8 bg-white rounded-full flex items-center justify-center mr-3 mt-1">
                                            <span class="text-blue-600 font-bold">3</span>
                                        </div>
                                        <p class="text-blue-800">Confirme os dados e autorize o pagamento</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Botão para checkout -->
                        <button onclick="goToCheckout()" class="w-full py-5 gradient-success hover:opacity-95 text-white font-semibold rounded-xl transition-all duration-300 flex items-center justify-center">
                            <i class="fas fa-external-link-alt mr-3 text-lg"></i>
                            Ir para Página de Pagamento
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let selectedAmount = 0.01;
        let currentPayment = null;
        
        // Função para gerar QR Code dinâmico
        function generateQRCode(text, elementId) {
            const qrContainer = document.getElementById(elementId);
            qrContainer.innerHTML = '';
            
            // Usando API do Google Charts para gerar QR Code
            const qrUrl = `https://chart.googleapis.com/chart?chs=250x250&cht=qr&chl=${encodeURIComponent(text)}&choe=UTF-8`;
            
            const img = document.createElement('img');
            img.src = qrUrl;
            img.alt = 'QR Code PIX';
            img.className = 'w-full h-auto';
            qrContainer.appendChild(img);
        }
        
        // Função para gerar código PIX de exemplo
        function generatePixCode(amount, transactionId) {
            // Código PIX padrão (em produção, isso viria da sua API)
            const merchantName = "Sistema de Pagamentos";
            const merchantCity = "São Paulo";
            const pixKey = "12345678900"; // CPF/CNPJ ou chave aleatória
            
            return `00020126580014br.gov.bcb.pix0136${pixKey}520400005303986540${amount.toFixed(2)}5802BR590${merchantName}600${merchantCity}621405${transactionId}6304`;
        }
        
        function selectAmount(amount) {
            selectedAmount = amount;
            document.getElementById('customAmount').value = amount.toFixed(2);
            
            // Feedback visual
            document.querySelectorAll('.amount-option').forEach(btn => {
                btn.classList.remove('border-blue-500', 'bg-blue-50', 'border-green-500', 'bg-green-50', 'border-purple-500', 'bg-purple-50');
            });
            
            // Adicionar classe baseada no valor
            const btn = event.target.closest('.amount-option');
            if (amount === 0.01) btn.classList.add('border-blue-500', 'bg-blue-50');
            else if (amount === 1.00) btn.classList.add('border-green-500', 'bg-green-50');
            else if (amount === 10.00) btn.classList.add('border-purple-500', 'bg-purple-50');
        }
        
        function processPayment() {
            const input = document.getElementById('customAmount');
            let value = parseFloat(input.value) || selectedAmount;
            
            if (value < 0.01) {
                showNotification("Valor mínimo é R$ 0,01", "error");
                return;
            }
            
            // Gerar ID de transação
            const transactionId = 'PIX' + Date.now().toString().slice(-10);
            
            // Atualizar interface
            document.getElementById('paymentId').textContent = transactionId;
            document.getElementById('paymentAmount').textContent = `R$ ${value.toFixed(2)}`;
            
            // Gerar código PIX
            const pixCode = generatePixCode(value, transactionId);
            document.getElementById('pixCodeText').textContent = pixCode;
            
            // Gerar QR Code
            generateQRCode(pixCode, 'qrCodeImage');
            
            // Salvar dados
            currentPayment = {
                id: transactionId,
                amount: value,
                pixCode: pixCode,
                timestamp: new Date().toISOString()
            };
            
            localStorage.setItem('currentPayment', JSON.stringify(currentPayment));
            
            // Mostrar resultados
            document.getElementById('resultSection').classList.remove('hidden');
            document.getElementById('resultSection').scrollIntoView({ behavior: 'smooth' });
            
            showNotification("Pagamento criado com sucesso!", "success");
        }
        
        function copyPixCode() {
            const pixCode = document.getElementById('pixCodeText').textContent;
            navigator.clipboard.writeText(pixCode)
                .then(() => showNotification("Código PIX copiado!", "success"))
                .catch(() => showNotification("Erro ao copiar", "error"));
        }
        
        function goToCheckout() {
            if (!currentPayment) {
                showNotification("Primeiro gere um pagamento", "error");
                return;
            }
            
            // Salvar dados para a próxima página
            localStorage.setItem('currentPayment', JSON.stringify(currentPayment));
            
            // Redirecionar para checkout.html (mesma pasta)
            window.location.href = 'checkout.html';
        }
        
        function showNotification(message, type = "info") {
            // Código do toast permanece
            const colors = {
                success: 'bg-green-600',
                error: 'bg-red-600',
                info: 'bg-blue-600'
            };
            
            const toast = document.createElement('div');
            toast.className = `fixed top-6 right-6 ${colors[type]} text-white px-6 py-4 rounded-xl shadow-2xl z-50 max-w-md`;
            toast.innerHTML = `
                <div class="flex items-center">
                    <i class="fas fa-${type === 'success' ? 'check' : type === 'error' ? 'exclamation' : 'info'}-circle mr-3"></i>
                    <span>${message}</span>
                </div>
            `;
            
            document.body.appendChild(toast);
            setTimeout(() => toast.remove(), 3000);
        }
        
        // Inicialização
        document.addEventListener('DOMContentLoaded', () => {
            // Selecionar valor padrão
            selectAmount(0.01);
            
            // Verificar se há pagamento salvo
            const saved = localStorage.getItem('currentPayment');
            if (saved) {
                currentPayment = JSON.parse(saved);
                document.getElementById('customAmount').value = currentPayment.amount.toFixed(2);
                selectAmount(currentPayment.amount);
            }
        });
    </script>
</body>
</html>